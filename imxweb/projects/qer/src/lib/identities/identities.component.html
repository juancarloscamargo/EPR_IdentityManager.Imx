<mat-card class="data-explorer data-explorer--identities" [class.identities--fullscreen]="showFullscreen">
  <div class="data-explorer-card-header">
    <div class="data-explorer-card-header-bg">
      <span translate>#LDS#Identities</span>
      <imx-help-contextual [contextId]="contextId"></imx-help-contextual>
    </div>
  </div>
  <imx-data-source-toolbar #dst [settings]="dstSettings" [options]="['search', 'sort', 'filter', 'groupBy', 'settings']" [busyService]="busyService"
    [searchBoxText]="'#LDS#Search' | translate" (navigationStateChanged)="onNavigationStateChanged($event)"
    (search)="onSearch($event)" (updateConfig)="updateConfig($event)" (deleteConfigById)="deleteConfigById($event)"></imx-data-source-toolbar>
  <div class="data-explorer-table">
    <imx-data-table [dst]="dst" (highlightedEntityChanged)="onIdentityChanged($event)" detailViewVisible="false"
      data-imx-identifier="identities-tabledata-table" mode="manual">
      <imx-data-table-column [entityColumn]="entitySchemaPersonReports?.Columns[DisplayColumns.DISPLAY_PROPERTYNAME]">
        <ng-template let-item>
          <div data-imx-identifier="identities-tabledata-display">{{ item.GetEntity().GetDisplay() }}</div>
          <div subtitle data-imx-identifier="identities-tabledata-description">{{
            item.DefaultEmailAddress.Column.GetDisplayValue() }}</div>
       </ng-template>
        
      </imx-data-table-column>
      
      
      
      <imx-data-table-column *ngIf="!this.isAdmin" [entityColumn]="entitySchemaPersonReports?.Columns.IsExternal">
      </imx-data-table-column>

      <imx-data-table-generic-column columnName="CCC_DepartmentFullPath" columnLabel="Dpto">
        <ng-template let-item>
          <div  [style.max-width]="'500px'" class="imx-ellipse-column">{{item.GetEntity().entityData.Columns.CCC_DepartmentFullPath.Value}}</div>
        </ng-template>
      </imx-data-table-generic-column>

      <imx-data-table-generic-column alignHeader="center" alignContent="center"
        [columnName]="entitySchemaPersonReports?.Columns.XMarkedForDeletion.ColumnName">
        <ng-template let-item>
          <div *ngIf="item.XMarkedForDeletion.value !== 0">
            <eui-badge color="gray">{{ item.XMarkedForDeletion.Column.GetDisplayValue() }}</eui-badge>
          </div>
        </ng-template>
      </imx-data-table-generic-column>
    </imx-data-table>

    <imx-data-source-paginator [dst]="dst"></imx-data-source-paginator>
  </div>
</mat-card>
<div class="data-explorer-bottom-button-row">
  <button *ngIf="isPersonAdmin || isManagerForPersons" mat-raised-button color="primary" data-imx-identifier="identities-button-create-new-identity" (click)="createNewIdentity()" class="imx-right-button">
    <eui-icon icon="add"></eui-icon>
    <span>Nuevo usuario</span>
  </button>
</div>
<ng-template #dynamicReport></ng-template>
